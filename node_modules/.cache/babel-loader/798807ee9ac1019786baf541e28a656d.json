{"ast":null,"code":"import _toConsumableArray from \"/home/dev-marcio/map-react/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"/home/dev-marcio/map-react/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/dev-marcio/map-react/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/dev-marcio/map-react/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/dev-marcio/map-react/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/dev-marcio/map-react/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/home/dev-marcio/map-react/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/home/dev-marcio/map-react/src/components/Map.jsx\";\nimport React, { Component } from 'react';\nimport ReactDOM from 'react-dom';\n\nvar Map =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Map, _Component);\n\n  function Map() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Map);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Map)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      position: [// position : determines the position of the items marked later\n      {\n        name: \"Cinemaxx Glória\",\n        location: {\n          lat: -21.20983949,\n          lng: -41.88704682\n        }\n      }, {\n        name: \"Cristo Redentor\",\n        location: {\n          lat: -21.20097577,\n          lng: -41.88172988\n        }\n      }, {\n        name: \"São José do Avaí\",\n        location: {\n          lat: -21.20188602,\n          lng: -41.88968531\n        }\n      }, {\n        name: \"Prefeitura Municipal\",\n        location: {\n          lat: -21.19874516,\n          lng: -41.904684232\n        }\n      }, {\n        name: \"Centro Poliesportivo\",\n        location: {\n          lat: -21.19495355,\n          lng: -41.90685375\n        }\n      }],\n      query: '',\n      markers: [],\n      infowindow: new _this.props.google.maps.InfoWindow(),\n      enhanceIcon: null\n    };\n\n    _this.onclickPosition = function () {\n      var that = _assertThisInitialized(_assertThisInitialized(_this));\n\n      var infowindow = _this.state.infowindow;\n\n      var displayInfowindow = function displayInfowindow(e) {\n        var markers = _this.state.markers;\n        var markerInd = markers.findIndex(function (mk) {\n          return mk.title.toLowerCase() === e.target.innerText.toLowerCase();\n        });\n        that.populateInfoWindow(markers[markerInd], infowindow);\n      };\n\n      document.querySelector('.position-list').addEventListener('click', function (e) {\n        if (e.target && e.target.nodeName === \"LI\") {\n          displayInfowindow(e);\n        }\n      });\n    };\n\n    _this.handleValueChange = function (e) {\n      _this.setState({\n        query: e.target.value\n      });\n    };\n\n    _this.addMarkers = function () {\n      var google = _this.props.google;\n      var infowindow = _this.state.infowindow;\n      var bounds = new google.maps.LatLngBounds();\n\n      _this.state.position.forEach(function (location, ind) {\n        var marker = new google.maps.Marker({\n          position: {\n            lat: location.location.lat,\n            lng: location.location.lng\n          },\n          map: _this.map,\n          title: location.name\n        });\n        marker.addListener('click', function () {\n          _this.populateInfoWindow(marker, infowindow);\n        });\n\n        _this.setState(function (state) {\n          return {\n            markers: _toConsumableArray(state.markers).concat([marker])\n          };\n        });\n\n        bounds.extend(marker.position);\n      });\n\n      _this.map.fitBounds(bounds);\n    };\n\n    _this.populateInfoWindow = function (marker, infowindow) {\n      var defaultIcon = marker.getIcon();\n      var _this$state = _this.state,\n          enhanceIcon = _this$state.enhanceIcon,\n          markers = _this$state.markers; // Check to make sure the infowindow is not already opened on this marker.\n\n      if (infowindow.marker !== marker) {\n        // reset the color of previous marker\n        if (infowindow.marker) {\n          var ind = markers.findIndex(function (m) {\n            return m.title === infowindow.marker.title;\n          });\n          markers[ind].setIcon(defaultIcon);\n        } // change marker icon color of clicked marker\n\n\n        marker.setIcon(enhanceIcon);\n        infowindow.marker = marker;\n        infowindow.setContent(\"<h3>\".concat(marker.title, \"</h3><h4>You are here!</h4>\"));\n        infowindow.open(_this.map, marker); // Make sure the marker property is cleared if the infowindow is closed.\n\n        infowindow.addListener('closeclick', function () {\n          infowindow.marker = null;\n        });\n      }\n    };\n\n    _this.makeMarkerIcon = function (markerColor) {\n      var google = _this.props.google;\n      var markerImage = new google.maps.MarkerImage('http://chart.googleapis.com/chart?chst=d_map_spin&chld=1.15|0|' + markerColor + '|40|_|%E2%80%A2', new google.maps.Size(21, 34), new google.maps.Point(0, 0), new google.maps.Point(10, 34), new google.maps.Size(21, 34));\n      return markerImage;\n    };\n\n    return _this;\n  }\n\n  _createClass(Map, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.loadMap();\n      this.onclickPosition(); // Create a \"highlighted location\" marker color for when the user\n      // clicks on the marker.\n\n      this.setState({\n        enhanceIcon: this.makeMarkerIcon('42be3f')\n      });\n    }\n  }, {\n    key: \"loadMap\",\n    value: function loadMap() {\n      if (this.props && this.props.google) {\n        var google = this.props.google;\n        var maps = google.maps;\n        var mapRef = this.refs.map;\n        var node = ReactDOM.findDOMNode(mapRef);\n        var mapConfig = Object.assign({}, {\n          center: {\n            lat: -21.1877747,\n            lng: -41.8799408\n          },\n          zoom: 12,\n          mapTypeId: 'roadmap'\n        });\n        this.map = new maps.Map(node, mapConfig);\n        this.addMarkers();\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state2 = this.state,\n          position = _this$state2.position,\n          query = _this$state2.query,\n          markers = _this$state2.markers,\n          infowindow = _this$state2.infowindow;\n\n      if (query) {\n        position.forEach(function (l, i) {\n          if (l.name.toLowerCase().includes(query.toLowerCase())) {\n            markers[i].setVisible(true);\n          } else {\n            if (infowindow.marker === markers[i]) {\n              // close the info window if marker removed\n              infowindow.close();\n            }\n\n            markers[i].setVisible(false);\n          }\n        });\n      } else {\n        position.forEach(function (l, i) {\n          if (markers.length && markers[i]) {\n            markers[i].setVisible(true);\n          }\n        });\n      }\n\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 151\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        \"aria-label\": \"container\",\n        className: \"container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 152\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"text-field\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        role: \"search\",\n        type: \"text\",\n        value: this.state.value,\n        onChange: this.handleValueChange,\n        placeholder: \"Search...\",\n        title: \"Type in a local\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 154\n        },\n        __self: this\n      }), React.createElement(\"ul\", {\n        className: \"position-list\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157\n        },\n        __self: this\n      }, markers.filter(function (mk) {\n        return mk.getVisible();\n      }).map(function (mk, i) {\n        return React.createElement(\"li\", {\n          key: i,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 159\n          },\n          __self: this\n        }, mk.title);\n      }))), React.createElement(\"div\", {\n        role: \"application\",\n        className: \"map\",\n        ref: \"map\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 162\n        },\n        __self: this\n      }, \"Loading ...\")));\n    }\n  }]);\n\n  return Map;\n}(Component);\n\nexport { Map as default };","map":{"version":3,"sources":["/home/dev-marcio/map-react/src/components/Map.jsx"],"names":["React","Component","ReactDOM","Map","state","position","name","location","lat","lng","query","markers","infowindow","props","google","maps","InfoWindow","enhanceIcon","onclickPosition","that","displayInfowindow","e","markerInd","findIndex","mk","title","toLowerCase","target","innerText","populateInfoWindow","document","querySelector","addEventListener","nodeName","handleValueChange","setState","value","addMarkers","bounds","LatLngBounds","forEach","ind","marker","Marker","map","addListener","extend","fitBounds","defaultIcon","getIcon","m","setIcon","setContent","open","makeMarkerIcon","markerColor","markerImage","MarkerImage","Size","Point","loadMap","mapRef","refs","node","findDOMNode","mapConfig","Object","assign","center","zoom","mapTypeId","l","i","includes","setVisible","close","length","filter","getVisible"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport ReactDOM from 'react-dom';\n\n\nexport default class Map extends Component {\n\n  state = {\n    position: [\n      // position : determines the position of the items marked later\n      { name: \"Cinemaxx Glória\", location: { lat: -21.20983949, lng: -41.88704682 } },\n      { name: \"Cristo Redentor\", location: { lat: -21.20097577, lng: -41.88172988 } },\n      { name: \"São José do Avaí\", location: { lat: -21.20188602, lng: -41.88968531 } },\n      { name: \"Prefeitura Municipal\", location: { lat: -21.19874516, lng: -41.904684232 } },\n      { name: \"Centro Poliesportivo\", location: { lat: -21.19495355, lng: -41.90685375 } }\n    ],\n    query: '',\n    markers: [],\n    infowindow: new this.props.google.maps.InfoWindow(),\n    enhanceIcon: null\n  }\n\n  componentDidMount() {\n    this.loadMap()\n    this.onclickPosition()\n    // Create a \"highlighted location\" marker color for when the user\n    // clicks on the marker.\n    this.setState({ enhanceIcon: this.makeMarkerIcon('42be3f') })\n  }\n\n  loadMap() {\n    if (this.props && this.props.google) {\n      const { google } = this.props\n      const maps = google.maps\n\n      const mapRef = this.refs.map\n      const node = ReactDOM.findDOMNode(mapRef)\n\n      const mapConfig = Object.assign({}, {\n        center: { lat: -21.1877747, lng: -41.8799408 },\n        zoom: 12,\n        mapTypeId: 'roadmap'\n      })\n\n      this.map = new maps.Map(node, mapConfig)\n      this.addMarkers()\n    }\n\n  }\n\n  onclickPosition = () => {\n    const that = this\n    const { infowindow } = this.state\n\n    const displayInfowindow = (e) => {\n      const { markers } = this.state\n      const markerInd =\n        markers.findIndex(mk => mk.title.toLowerCase() === e.target.innerText.toLowerCase())\n      that.populateInfoWindow(markers[markerInd], infowindow)\n    }\n    document.querySelector('.position-list').addEventListener('click', function (e) {\n      if (e.target && e.target.nodeName === \"LI\") {\n        displayInfowindow(e)\n      }\n    })\n  }\n\n  handleValueChange = (e) => {\n    this.setState({ query: e.target.value })\n  }\n\n  addMarkers = () => {\n    const { google } = this.props\n    let { infowindow } = this.state\n    const bounds = new google.maps.LatLngBounds()\n\n    this.state.position.forEach((location, ind) => {\n      const marker = new google.maps.Marker({\n        position: { lat: location.location.lat, lng: location.location.lng },\n        map: this.map,\n        title: location.name\n      })\n\n      marker.addListener('click', () => {\n        this.populateInfoWindow(marker, infowindow)\n      })\n      this.setState((state) => ({\n        markers: [...state.markers, marker]\n      }))\n      bounds.extend(marker.position)\n    })\n    this.map.fitBounds(bounds)\n  }\n\n  populateInfoWindow = (marker, infowindow) => {\n    const defaultIcon = marker.getIcon()\n    const { enhanceIcon, markers } = this.state\n    // Check to make sure the infowindow is not already opened on this marker.\n    if (infowindow.marker !== marker) {\n      // reset the color of previous marker\n      if (infowindow.marker) {\n        const ind = markers.findIndex(m => m.title === infowindow.marker.title)\n        markers[ind].setIcon(defaultIcon)\n      }\n      // change marker icon color of clicked marker\n      marker.setIcon(enhanceIcon)\n      infowindow.marker = marker\n      infowindow.setContent(`<h3>${marker.title}</h3><h4>You are here!</h4>`)\n      infowindow.open(this.map, marker)\n      // Make sure the marker property is cleared if the infowindow is closed.\n      infowindow.addListener('closeclick', function () {\n        infowindow.marker = null\n      })\n    }\n  }\n\n  makeMarkerIcon = (markerColor) => {\n    const { google } = this.props\n    let markerImage = new google.maps.MarkerImage(\n      'http://chart.googleapis.com/chart?chst=d_map_spin&chld=1.15|0|' + markerColor +\n      '|40|_|%E2%80%A2',\n      new google.maps.Size(21, 34),\n      new google.maps.Point(0, 0),\n      new google.maps.Point(10, 34),\n      new google.maps.Size(21, 34));\n    return markerImage;\n  }\n\n  render() {\n    const { position, query, markers, infowindow } = this.state\n    if (query) {\n      position.forEach((l, i) => {\n        if (l.name.toLowerCase().includes(query.toLowerCase())) {\n          markers[i].setVisible(true)\n        } else {\n          if (infowindow.marker === markers[i]) {\n            // close the info window if marker removed\n            infowindow.close()\n          }\n          markers[i].setVisible(false)\n        }\n      })\n    } else {\n      position.forEach((l, i) => {\n        if (markers.length && markers[i]) {\n          markers[i].setVisible(true)\n        }\n      })\n    }\n\n    return (\n      <div>\n        <div aria-label=\"container\" className=\"container\">\n          <div className=\"text-field\">\n            <input role=\"search\" type='text'\n              value={this.state.value} \n              onChange={this.handleValueChange} placeholder=\"Search...\" title=\"Type in a local\"/>\n            <ul className=\"position-list\" >{\n              markers.filter(mk => mk.getVisible()).map((mk, i) =>\n                (<li key={i}>{mk.title}</li>))\n            }</ul>\n          </div>\n          <div role=\"application\" className=\"map\" ref=\"map\">\n            Loading ...\n          </div>\n        </div>\n      </div>\n    )\n  }\n}"]},"metadata":{},"sourceType":"module"}